"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[552],{8552:(E,C,c)=>{c.r(C),c.d(C,{HomeEspecialistasModule:()=>w});var u=c(6814),r=c(9517),m=c(5861),v=c(2572),h=c(7398),P=c(3519),o=c.n(P),t=c(5879),p=c(9113),d=c(588),l=c(6223),g=c(154);function T(a,_){1&a&&(t.TgZ(0,"div",11),t._UZ(1,"div",12),t.qZA())}function b(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.confirmarTurno(i))}),t._uU(1,"Si "),t.qZA()}}function Z(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.cancelarTurno(i))}),t._uU(1,"No "),t.qZA()}}function A(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.finalizarTurno(i))}),t._uU(1,"Finalizar "),t.qZA()}}function L(a,_){if(1&a){const e=t.EpF();t.TgZ(0,"span",20)(1,"i",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw();return t.KtG(s.verComentariosTurno(i))}),t.qZA()()}}function O(a,_){if(1&a&&(t.TgZ(0,"tr")(1,"td")(2,"p",13),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td")(11,"span",14),t._uU(12),t.qZA()(),t.TgZ(13,"td"),t.YNc(14,b,2,0,"button",15),t.YNc(15,Z,2,0,"button",15),t.YNc(16,A,2,0,"button",16),t.qZA(),t.TgZ(17,"td"),t.YNc(18,L,2,0,"span",17),t.qZA()()),2&a){const e=_.$implicit,n=t.oxw();t.xp6(3),t.Oqu(e.nombrePaciente),t.xp6(2),t.hij(" ",e.fecha," "),t.xp6(2),t.hij(" ",e.horaInicio," "),t.xp6(2),t.hij(" ",e.especialidad," "),t.xp6(2),t.Q6J("ngClass",n.getColorPorEstado(e.estado)),t.xp6(1),t.hij(" ",e.estado," "),t.xp6(2),t.Q6J("ngIf","pendiente"===e.estado),t.xp6(1),t.Q6J("ngIf","pendiente"===e.estado),t.xp6(1),t.Q6J("ngIf","confirmado"===e.estado),t.xp6(2),t.Q6J("ngIf",""!==e.comentarios&&void 0!==e.comentarios||""!==e.resenia&&void 0!==e.resenia)}}const I=[{path:"",component:(()=>{class a{constructor(e,n,i,s){this.turnoService=e,this.dataquery=n,this.formBuilder=i,this.authService=s,this.isLoading=!1}ngOnInit(){this.filtroForm=this.formBuilder.group({paciente:[""],especialidad:[""]}),this.isLoading=!0;const e=this.turnoService.getTurnos(),n=this.turnoService.getPacientes();this.authService.getLoggedUser().subscribe(i=>{this.usuarioLogueado=i}),(0,v.a)([e,n,this.authService.getLoggedUser()]).pipe((0,h.U)(([i,s,f])=>i.filter(x=>x.uidEspecialista===f?.uid).map(x=>{const y=s.find(B=>B.uid===x.uidPaciente);return{...x,nombrePaciente:y?`${y.apellido}, ${y.nombre}`:"Paciente no encontrado"}}))).subscribe(i=>{this.turnosDetallado=i,this.turnosFiltrado=this.turnosDetallado,this.isLoading=!1}),this.formSubscription=this.filtroForm.valueChanges.subscribe(i=>{this.turnosFiltrado=this.filtrarTurnos(this.turnosDetallado,i)})}filtrarTurnos(e,n){return e&&"string"==typeof n.especialidad?e.filter(i=>{const s="string"==typeof i.especialidad&&i.especialidad.toLowerCase().includes(n.especialidad?.toLowerCase()),f="string"==typeof i.nombrePaciente&&i.nombrePaciente.toLowerCase().includes(n.paciente?.toLowerCase());return s&&f}):[]}getColorPorEstado(e){switch(e){case"confirmado":return"badge rounded-pill text-bg-success";case"finalizado":return"badge rounded-pill text-bg-warning";case"cancelado":case"rechazado":return"badge rounded-pill text-bg-danger";case"pendiente":return"badge rounded-pill text-bg-secondary";default:return"badge rounded-pill text-bg-muted"}}cancelarTurno(e){var i,n=this;o().fire({title:"\xbfDesea cancelar?",html:`\n      Detalles del turno\n      <p>Paciente: ${e.nombrePaciente}</p>\n      <p>Especialidad: ${e.especialidad}</p>\n      <p>Fecha: ${e.fecha}</p>\n      <p>Hora de Inicio: ${e.horaInicio}</p>\n    `,input:"text",inputPlaceholder:"Ingrese el motivo de la cancelaci\xf3n",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"S\xed, cancelar",showLoaderOnConfirm:!0,preConfirm:(i=(0,m.Z)(function*(s){console.log(e.id,s),n.turnoService.cancelarTurno(e.id,s)}),function(f){return i.apply(this,arguments)}),allowOutsideClick:()=>!o().isLoading()}).then(i=>{i.isConfirmed&&o().fire("Cancelado","La acci\xf3n fue cancelada.","success")})}confirmarTurno(e){var i,n=this;o().fire({title:"\xbfConfirmar?",html:`\n        Detalles del turno\n        <p>Paciente: ${e.nombrePaciente}</p>\n        <p>Especialidad: ${e.especialidad}</p>\n        <p>Fecha: ${e.fecha}</p>\n        <p>Hora de Inicio: ${e.horaInicio}</p>\n      `,showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"S\xed, confirmar",showLoaderOnConfirm:!0,preConfirm:(i=(0,m.Z)(function*(){n.turnoService.confirmarTurno(e.id)}),function(){return i.apply(this,arguments)}),allowOutsideClick:()=>!o().isLoading()}).then(i=>{i.isConfirmed&&o().fire("Confirmado","El turno fue confirmado.","success")})}calificarTurno(e){var i,n=this;o().fire({title:"Calificar atenci\xf3n",input:"text",html:'<input type="range" id="calificacion" name="calificacion" min="1" max="5">',inputPlaceholder:"\xbfComo estuvo la atenci\xf3n?",showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Aceptar",showLoaderOnConfirm:!0,preConfirm:(i=(0,m.Z)(function*(s){const f=document.getElementById("calificacion").value;console.log(e.id,s,f),n.turnoService.calificarTurno(e.id,s,f)}),function(f){return i.apply(this,arguments)}),allowOutsideClick:()=>!o().isLoading()}).then(i=>{i.isConfirmed&&o().fire("Gracias","Se envio la calificaci\xf3n","success")})}finalizarTurno(e){var i,n=this;o().fire({title:"\xbfTurno finalizado?",html:`\n      Detalles del turno\n      <p>Paciente: ${e.nombrePaciente}</p>\n      <p>Especialidad: ${e.especialidad}</p>\n      <p>Fecha: ${e.fecha}</p>\n      <p>Hora de Inicio: ${e.horaInicio}</p>\n    `,input:"text",inputPlaceholder:"Comentarios",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"S\xed, cancelar",showLoaderOnConfirm:!0,preConfirm:(i=(0,m.Z)(function*(s){n.turnoService.finalizarTurno(e.id,s)}),function(f){return i.apply(this,arguments)}),allowOutsideClick:()=>!o().isLoading()}).then(i=>{i.isConfirmed&&o().fire("Finalizado","El turno fue finalizado.","success")})}verComentariosTurno(e){let n=`\n      <p><strong>Comentarios:</strong> ${e.comentarios}</p>\n      \n    `;""!==e.resenia&&(n+=`\n      <p><strong>Rese\xf1a:</strong> ${e.resenia}</p>\n      `),""!==e.calificacion&&(n+=`\n        <label for="calificacion">Calificaci\xf3n:</label>\n        <input type="range" id="calificacion" name="calificacion" min="1" max="5" value="${e.calificacion}" disabled>\n      `),o().fire({title:"Comentarios",html:n,confirmButtonText:"Cerrar",allowOutsideClick:()=>!o().isLoading()})}static#t=this.\u0275fac=function(n){return new(n||a)(t.Y36(p.D),t.Y36(d.e),t.Y36(l.qu),t.Y36(g.e))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["app-home-especialistas"]],decls:30,vars:3,consts:[["class","overlay",4,"ngIf"],[1,"turnos-container"],[3,"formGroup"],[1,"filtro-container"],["for","especialista"],["type","text","formControlName","paciente"],["for","especialidad"],["type","text","formControlName","especialidad"],[1,"table","align-middle","mb-0","bg-white"],[1,"bg-light"],[4,"ngFor","ngForOf"],[1,"overlay"],[1,"spinner"],[1,"fw-normal","mb-1"],[3,"ngClass"],["type","button","class","btn btn-outline-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-warning btn-sm",3,"click",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-outline-warning","btn-sm",3,"click"],[1,"d-flex","justify-content-center"],[1,"fas","fa-eye","text-muted",3,"click"]],template:function(n,i){1&n&&(t.YNc(0,T,2,0,"div",0),t.TgZ(1,"div",1)(2,"form",2)(3,"div",3)(4,"label",4),t._uU(5,"Paciente:"),t.qZA(),t._UZ(6,"input",5),t.TgZ(7,"label",6),t._uU(8,"Especialidad:"),t.qZA(),t._UZ(9,"input",7),t.qZA(),t.TgZ(10,"table",8)(11,"thead",9)(12,"tr")(13,"th"),t._uU(14,"Paciente"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Fecha"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Hora"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Especialidad"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Estado"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Accion"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Comentarios"),t.qZA()()(),t.TgZ(27,"tbody"),t.YNc(28,O,19,10,"tr",10),t._UZ(29,"tr"),t.qZA()()()()),2&n&&(t.Q6J("ngIf",i.isLoading),t.xp6(2),t.Q6J("formGroup",i.filtroForm),t.xp6(26),t.Q6J("ngForOf",i.turnosFiltrado))},dependencies:[u.mk,u.sg,u.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u],styles:[".overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fffc;display:flex;align-items:center;justify-content:center;z-index:9999}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #e64141;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.filtro-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:10px}.btn-nuevo-turno[_ngcontent-%COMP%]{position:absolute;right:0;margin-right:40px;margin-top:5px}"]})}return a})(),children:[]}];let U=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({imports:[u.ez,r.Bz.forChild(I),r.Bz]})}return a})(),w=(()=>{class a{static#t=this.\u0275fac=function(n){return new(n||a)};static#e=this.\u0275mod=t.oAB({type:a});static#i=this.\u0275inj=t.cJS({imports:[u.ez,U,l.u5,l.UX]})}return a})()},588:(E,C,c)=>{c.d(C,{e:()=>v});var u=c(5861),r=c(5349),m=c(5879);let v=(()=>{class h{constructor(o){this.firestore=o}getObraSociales(){const o=(0,r.hJ)(this.firestore,"obrasSociales");return(0,r.BS)(o)}getEspecialidades(){const o=(0,r.hJ)(this.firestore,"especialidades");return(0,r.BS)(o)}getProxIdEspecialidades(){var o=this;return(0,u.Z)(function*(){const t=(0,r.hJ)(o.firestore,"especialidades"),p=(0,r.IO)(t,(0,r.Xo)("id","desc")),d=yield(0,r.PL)(p);return d.empty?1:d.docs[0].get("id")+1})()}altaEspecialidad(o){var t=this;return(0,u.Z)(function*(){const p=yield t.getProxIdEspecialidades(),d=(0,r.hJ)(t.firestore,"especialidades");(0,r.ET)(d,{id:p,nombre:o.toLowerCase()})})()}traerUsuarios(){const o=(0,r.hJ)(this.firestore,"usuarios");return(0,r.BS)(o)}getPacientes(){var o=this;return(0,u.Z)(function*(){const t=(0,r.hJ)(o.firestore,"usuarios"),p=(0,r.IO)(t,(0,r.ar)("perfil","==","paciente")),d=yield(0,r.PL)(p),l=[];return d.forEach(g=>{l.push(g.data())}),l})()}cambiarEstadoUsuario(o,t){var p=this;return(0,u.Z)(function*(){const d=(0,r.hJ)(p.firestore,"usuarios"),l=(0,r.IO)(d,(0,r.ar)("uid","==",o)),g=yield(0,r.PL)(l);return 0!==g.size&&(g.forEach(function(){var T=(0,u.Z)(function*(b){const Z=b.ref;yield(0,r.pl)(Z,{estado:t},{merge:!0})});return function(b){return T.apply(this,arguments)}}()),!0)})()}static#t=this.\u0275fac=function(t){return new(t||h)(m.LFG(r.gg))};static#e=this.\u0275prov=m.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()}}]);