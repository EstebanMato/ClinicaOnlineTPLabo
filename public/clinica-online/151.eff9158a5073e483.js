"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[151],{7151:(T,x,d)=>{d.r(x),d.d(x,{PacientesModule:()=>S});var l=d(6814),o=d(9517),D=d(2572),b=d(7398),P=d(8304),e=d(5879),r=d(9113),a=d(154);let i=(()=>{class s{constructor(t,n){this.el=t,this.renderer=n}onMouseEnter(){this.applyEffect("#000080","scale(1.1)")}onMouseLeave(){this.applyEffect("","")}applyEffect(t,n){this.renderer.setStyle(this.el.nativeElement,"background-color",t),this.renderer.setStyle(this.el.nativeElement,"transform",n),this.renderer.setStyle(this.el.nativeElement,"transition","all 0.3s ease-in-out")}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(e.SBq),e.Y36(e.Qsj))};static#t=this.\u0275dir=e.lG2({type:s,selectors:[["","appHoverEffect",""]],hostBindings:function(n,c){1&n&&e.NdJ("mouseenter",function(){return c.onMouseEnter()})("mouseleave",function(){return c.onMouseLeave()})}})}return s})();function u(s,g){if(1&s&&(e.ynx(0),e.TgZ(1,"p",16),e._uU(2),e.qZA(),e.BQk()),2&s){const t=g.$implicit;e.xp6(2),e.hij("Fecha: ",t.fecha,"")}}function f(s,g){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",10)(2,"div",11),e._UZ(3,"img",12),e.TgZ(4,"div",13)(5,"h5",14),e._uU(6),e.qZA(),e.YNc(7,u,3,1,"ng-container",2),e.TgZ(8,"a",15),e.NdJ("click",function(){const C=e.CHM(t).$implicit,v=e.oxw();return e.KtG(v.historiaClinicaPaciente(C))}),e._uU(9," Historia Clinica"),e.qZA()()()(),e.BQk()}if(2&s){const t=g.$implicit,n=e.oxw();e.xp6(3),e.Q6J("src",null==t?null:t.imagen[0],e.LSH),e.xp6(3),e.AsE("",t.apellido,", ",t.nombre,""),e.xp6(1),e.Q6J("ngForOf",n.obtenerTresTurnosPorPaciente(t.uid))}}function p(s,g){if(1&s&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&s){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.datosDinamicos.dato1.nombre,": ",t.datosDinamicos.dato1.valor,"")}}function m(s,g){if(1&s&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&s){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.datosDinamicos.dato2.nombre,": ",t.datosDinamicos.dato2.valor,"")}}function h(s,g){if(1&s&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&s){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.datosDinamicos.dato3.nombre,": ",t.datosDinamicos.dato3.valor,"")}}function _(s,g){if(1&s&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e._uU(3),e._UZ(4,"br"),e._uU(5),e._UZ(6,"br"),e._uU(7),e._UZ(8,"br"),e._uU(9),e._UZ(10,"br"),e._uU(11),e._UZ(12,"br"),e._uU(13),e._UZ(14,"br"),e.YNc(15,p,3,2,"ng-container",17),e.YNc(16,m,3,2,"ng-container",17),e.YNc(17,h,3,2,"ng-container",17),e._UZ(18,"hr"),e.BQk()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" Fecha: ",t.fecha,", ",t.horaInicio,""),e.xp6(2),e.hij(" Comentarios: ",t.comentarios,""),e.xp6(2),e.hij(" Altura: ",t.datosFijos.altura,""),e.xp6(2),e.hij(" Peso: ",t.datosFijos.peso,""),e.xp6(2),e.hij(" Presion: ",t.datosFijos.presion,""),e.xp6(2),e.hij(" Temperatura: ",t.datosFijos.temperatura,""),e.xp6(2),e.hij(" Diagnostico: ",t.datosFijos.diagnostico,""),e.xp6(2),e.Q6J("ngIf",""!=t.datosDinamicos.dato1.nombre),e.xp6(1),e.Q6J("ngIf",""!=t.datosDinamicos.dato2.nombre),e.xp6(1),e.Q6J("ngIf",""!=t.datosDinamicos.dato3.nombre)}}function y(s,g){if(1&s&&(e.ynx(0),e.YNc(1,_,19,11,"ng-container",17),e.BQk()),2&s){const t=g.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",t.uidPaciente==(null==n.pacienteSeleccionado?null:n.pacienteSeleccionado.uid))}}const U=[{path:"",component:(()=>{class s{constructor(t,n){this.turnoService=t,this.authService=n,this.isLoading=!1,this.arrayPacientes=[]}ngOnInit(){this.isLoading=!0,this.authService.getLoggedUser().subscribe(t=>{t&&this.authService.getUsuarioPorUid(t.uid).subscribe(n=>{this.usuario=n[0],this.isLoading=!1,this.getTurnosAtendidos()})})}getTurnosAtendidos(){this.isLoading=!0;const t=this.turnoService.getTurnos(),n=this.turnoService.getPacientes();(0,D.a)([t,n]).pipe((0,b.U)(([c,C])=>c.filter(v=>v.uidEspecialista===this.usuario?.uid&&"finalizado"===v.estado).map(v=>{const L=C.find(I=>I.uid===v.uidPaciente);return{...v,nombrepaciente:L?`${L.apellido}, ${L.nombre}`:"Paciente no encontrado"}}))).subscribe(c=>{this.turnosDetallado=this.ordenarPorFecha(c),this.isLoading=!1,this.arrayUidPacientes=this.getPacientesUnicos()})}getPacientesUnicos(){const t=[];return this.turnosDetallado&&this.turnosDetallado.forEach(n=>{n&&n.uidPaciente&&!t.includes(n.uidPaciente)&&(t.push(n.uidPaciente),this.authService.getUsuarioPorUid(n.uidPaciente).subscribe(c=>{this.arrayPacientes.push(c[0])}))}),t}ordenarPorFecha(t){return t.sort((n,c)=>{const C=this.convertirAFecha(n.fecha),v=this.convertirAFecha(c.fecha);return C.getTime()-v.getTime()}),t}convertirAFecha(t){const n=t.split("/");return new Date(parseInt(n[2]),parseInt(n[1])-1,parseInt(n[0]))}obtenerTresTurnosPorPaciente(t){let n=0;return this.turnosDetallado.filter(c=>c.uidPaciente===t&&n<3&&(n++,!0))}historiaClinicaPaciente(t){this.pacienteSeleccionado=t}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(r.D),e.Y36(a.e))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-pacientes"]],decls:12,vars:5,consts:[[1,"container"],[1,"row","mt-4"],[4,"ngFor","ngForOf"],["id","HistoriaClinica","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabels",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"col-md-3","mb-3"],[1,"card",2,"width","100%"],["alt","imagenPerfil",1,"card-img-top","square-image",3,"src"],[1,"card-body"],[1,"card-title"],["data-bs-dismiss","modal","data-bs-toggle","modal","data-bs-target","#HistoriaClinica","appHoverEffect","",1,"btn","btn-primary",3,"click"],[1,"card-text"],[4,"ngIf"]],template:function(n,c){1&n&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,f,10,4,"ng-container",2),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h5",7),e._uU(8),e.qZA(),e._UZ(9,"button",8),e.qZA(),e.TgZ(10,"div",9),e.YNc(11,y,2,1,"ng-container",2),e.qZA()()()()),2&n&&(e.Q6J("@fadeInUp",void 0),e.xp6(2),e.Q6J("ngForOf",c.arrayPacientes),e.xp6(6),e.AsE("",null==c.pacienteSeleccionado?null:c.pacienteSeleccionado.nombre,", ",null==c.pacienteSeleccionado?null:c.pacienteSeleccionado.apellido,". Historia cl\xednica "),e.xp6(3),e.Q6J("ngForOf",c.turnosDetallado))},dependencies:[l.sg,l.O5,i],styles:[".overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fffc;display:flex;align-items:center;justify-content:center;z-index:9999}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #e64141;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.square-image[_ngcontent-%COMP%]{aspect-ratio:1/1;object-fit:cover}"],data:{animation:[P.X]}})}return s})(),children:[]}];let F=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#i=this.\u0275inj=e.cJS({imports:[l.ez,o.Bz.forChild(U),o.Bz]})}return s})();var Z=d(2514);let S=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#i=this.\u0275inj=e.cJS({imports:[l.ez,F,Z.I]})}return s})()},2514:(T,x,d)=>{d.d(x,{I:()=>D});var l=d(6814),o=d(5879);let D=(()=>{class b{static#e=this.\u0275fac=function(r){return new(r||b)};static#t=this.\u0275mod=o.oAB({type:b});static#i=this.\u0275inj=o.cJS({imports:[l.ez]})}return b})()},9113:(T,x,d)=>{d.d(x,{D:()=>b});var l=d(5861),o=d(5349),D=d(5879);let b=(()=>{class P{constructor(r){this.firestore=r}getEspecialidades(){const r=(0,o.hJ)(this.firestore,"especialidades");return(0,o.BS)(r)}getEspecialistas(){const r=(0,o.hJ)(this.firestore,"usuarios"),a=(0,o.IO)(r,(0,o.ar)("perfil","==","especialista"),(0,o.ar)("estado","==",!0));return(0,o.BS)(a)}getPacientes(){const r=(0,o.hJ)(this.firestore,"usuarios"),a=(0,o.IO)(r,(0,o.ar)("perfil","==","paciente"),(0,o.ar)("estado","==",!0));return(0,o.BS)(a)}getTurnos(){const r=(0,o.hJ)(this.firestore,"turnos");return(0,o.BS)(r)}crearTurno(r){var a=this;return(0,l.Z)(function*(){const i=yield a.getProxIdTurno(),u=(0,o.hJ)(a.firestore,"turnos");(0,o.ET)(u,{id:i,uidPaciente:r.uidPaciente,uidEspecialista:r.uidEspecialista,estado:r.estado,fecha:r.fecha,horaFin:r.horaFin,horaInicio:r.horaInicio,comentarios:r.comentarios,calificacion:r.calificacion,especialidad:r.especialidad,resenia:""})})()}getProxIdTurno(){var r=this;return(0,l.Z)(function*(){const a=(0,o.hJ)(r.firestore,"turnos"),i=(0,o.IO)(a,(0,o.Xo)("id","desc")),u=yield(0,o.PL)(i);return u.empty?1:u.docs[0].get("id")+1})()}cancelarTurno(r,a){var i=this;return(0,l.Z)(function*(){const u=(0,o.hJ)(i.firestore,"turnos"),f=(0,o.IO)(u,(0,o.ar)("id","==",r)),p=yield(0,o.PL)(f);return 0!==p.size&&(p.forEach(function(){var m=(0,l.Z)(function*(h){const _=h.ref;yield(0,o.pl)(_,{estado:"cancelado",comentarios:a},{merge:!0})});return function(h){return m.apply(this,arguments)}}()),!0)})()}finalizarTurno(r,a,i,u){var f=this;return(0,l.Z)(function*(){const p=(0,o.hJ)(f.firestore,"turnos"),m=(0,o.IO)(p,(0,o.ar)("id","==",r)),h=yield(0,o.PL)(m);return 0!==h.size&&(h.forEach(function(){var _=(0,l.Z)(function*(y){const E=y.ref;yield(0,o.pl)(E,{estado:"finalizado",comentarios:u,datosFijos:a,datosDinamicos:i},{merge:!0})});return function(y){return _.apply(this,arguments)}}()),!0)})()}confirmarTurno(r){var a=this;return(0,l.Z)(function*(){const i=(0,o.hJ)(a.firestore,"turnos"),u=(0,o.IO)(i,(0,o.ar)("id","==",r)),f=yield(0,o.PL)(u);return 0!==f.size&&(f.forEach(function(){var p=(0,l.Z)(function*(m){const h=m.ref;yield(0,o.pl)(h,{estado:"confirmado"},{merge:!0})});return function(m){return p.apply(this,arguments)}}()),!0)})()}calificarTurno(r,a,i){var u=this;return(0,l.Z)(function*(){const f=(0,o.hJ)(u.firestore,"turnos"),p=(0,o.IO)(f,(0,o.ar)("id","==",r)),m=yield(0,o.PL)(p);return 0!==m.size&&(m.forEach(function(){var h=(0,l.Z)(function*(_){const y=_.ref;yield(0,o.pl)(y,{resenia:a,calificacion:i},{merge:!0})});return function(_){return h.apply(this,arguments)}}()),!0)})()}filtrarTurnos(r,a){return r&&"string"==typeof a.filtrar?r.filter(i=>{const u="string"==typeof i.especialidad.nombre&&i.especialidad.nombre.toLowerCase().includes(a.filtrar?.toLowerCase()),f=i.nombreEspecialista&&"string"==typeof i.nombreEspecialista&&i.nombreEspecialista.toLowerCase().includes(a.filtrar?.toLowerCase()),p=i.nombrePaciente&&"string"==typeof i.nombrePaciente&&i.nombrePaciente.toLowerCase().includes(a.filtrar?.toLowerCase()),m="string"==typeof i.fecha&&i.fecha.toLowerCase().includes(a.filtrar?.toLowerCase()),h="string"==typeof i.horaInicio&&i.horaInicio.toLowerCase().includes(a.filtrar?.toLowerCase()),_="string"==typeof i.estado&&i.estado.toLowerCase().includes(a.filtrar?.toLowerCase()),y=i.datosDinamicos&&("string"==typeof i.datosDinamicos.dato1?.nombre&&i.datosDinamicos.dato1.nombre.toLowerCase().includes(a.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato2?.nombre&&i.datosDinamicos.dato2.nombre.toLowerCase().includes(a.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato3?.nombre&&i.datosDinamicos.dato3.nombre.toLowerCase().includes(a.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato1?.valor&&i.datosDinamicos.dato1.valor.toLowerCase().includes(a.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato2?.valor&&i.datosDinamicos.dato2.valor.toLowerCase().includes(a.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato3?.valor&&i.datosDinamicos.dato3.valor.toLowerCase().includes(a.filtrar?.toLowerCase())),E=i.datosFijos&&("number"==typeof i.datosFijos.altura&&i.datosFijos.altura.toString().includes(a.filtrar)||"string"==typeof i.datosFijos.diagnostico&&i.datosFijos.diagnostico.toLowerCase().includes(a.filtrar?.toLowerCase())||"number"==typeof i.datosFijos.peso&&i.datosFijos.peso.toString().includes(a.filtrar)||"number"==typeof i.datosFijos.presion&&i.datosFijos.presion.toString().includes(a.filtrar)||"number"==typeof i.datosFijos.temperatura&&i.datosFijos.temperatura.toString().includes(a.filtrar));return u||p||f||m||h||_||y||E}):[]}static#e=this.\u0275fac=function(a){return new(a||P)(D.LFG(o.gg))};static#t=this.\u0275prov=D.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"})}return P})()}}]);