"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[340],{9340:(Y,h,o)=>{o.r(h),o.d(h,{RegisterEmpleadoModule:()=>k});var p=o(6814),u=o(9517),g=o(5861),i=o(6223),Z=o(1614),b=o(3519),m=o.n(b),_=o(8304),e=o(5879),E=o(588),A=o(130),y=o(154),I=o(9278),v=o(2530);function C(t,l){1&t&&(e.TgZ(0,"div",34),e._UZ(1,"div",35),e.qZA())}function N(t,l){1&t&&(e.ynx(0),e.TgZ(1,"small",36),e._uU(2,"S\xf3lo debe contener letras"),e.qZA(),e.BQk())}function T(t,l){1&t&&(e.ynx(0),e.TgZ(1,"small",36),e._uU(2,"S\xf3lo debe contener letras"),e.qZA(),e.BQk())}function U(t,l){1&t&&(e.ynx(0),e.TgZ(1,"small",36),e._uU(2,"S\xf3lo debe contener n\xfameros"),e.qZA(),e.BQk())}function x(t,l){1&t&&(e.ynx(0),e.TgZ(1,"small",36),e._uU(2,"Formato inv\xe1lido"),e.qZA(),e.BQk())}function w(t,l){1&t&&(e.ynx(0),e.TgZ(1,"small",36),e._uU(2,"La contrase\xf1a debe tener al menos 6 caracteres"),e.qZA(),e.BQk())}function q(t,l){if(1&t&&(e.TgZ(0,"option"),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&t){const a=l.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,a.nombre))}}function F(t,l){1&t&&(e.ynx(0),e.TgZ(1,"small",36),e._uU(2,"S\xf3lo debe contener letras en min\xfasculas"),e.qZA(),e.BQk())}function S(t,l){1&t&&(e.TgZ(0,"div")(1,"div",36),e._uU(2,"La fecha debe ser entre el 01/01/1900 y la fecha actual."),e.qZA()())}function R(t,l){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const a=e.oxw();e.xp6(1),e.Oqu(a.archivo.name)}}const J=[{path:"",component:(()=>{class t{constructor(a,r,n,s,c,d){this.dataqueryService=a,this.storageService=r,this.authService=n,this.router=s,this.formBuilder=c,this.recaptchaService=d,this.captchaResolved=!1,this.especialidades=[],this.archivo=null,this.isLoading=!1,this.especialidadUsuario=[]}ngOnInit(){this.siteKey=this.recaptchaService.getSiteKey(),this.aFormGroup=this.formBuilder.group({recaptcha:["",i.kI.required]}),this.form=new i.cw({nombre:new i.NI("",[i.kI.pattern("^[a-zA-Z ]+$"),i.kI.required]),apellido:new i.NI("",[i.kI.pattern("^[a-zA-Z ]+$"),i.kI.required]),dni:new i.NI("",[i.kI.pattern("^[0-9]+$"),i.kI.required]),mail:new i.NI("",[i.kI.email,i.kI.required]),password:new i.NI("",[i.kI.minLength(6),i.kI.required]),fechaNacimiento:new i.NI("",[i.kI.required,Z.j]),especialidad:new i.NI(""),img:new i.NI("",[i.kI.required]),nuevaEspecialidad:new i.NI("",[i.kI.pattern("^[a-z ]+$")])}),this.dataqueryService.getEspecialidades().subscribe(a=>{this.especialidades=a})}handleSuccess(a){console.log("reCAPTCHA resuelto:",a),this.captchaResolved=!0}get nombre(){return this.form.get("nombre")}get apellido(){return this.form.get("apellido")}get dni(){return this.form.get("dni")}get mail(){return this.form.get("mail")}get password(){return this.form.get("password")}get especialidad(){return this.form.get("especialidad")}get fechaNacimiento(){return this.form.get("fechaNacimiento")}get img(){return this.form.get("img")}get nuevaEspecialidad(){return this.form.get("nuevaEspecialidad")}registrarse(){var a=this;return(0,g.Z)(function*(){try{a.isLoading=!0,a.especialidadUsuario=[],yield a.authService.registrarUsuario(a.mail?.value,a.password?.value).then(r=>{if(a.especialidad?.value&&""!=a.especialidad?.value)for(const n of a.especialidad.value){console.log(n);const s=n.toLowerCase();a.especialidadUsuario.push(s)}a.nuevaEspecialidad?.pristine||a.especialidadUsuario.push(a.nuevaEspecialidad?.value),a.cargarImagen(a.archivo).then(()=>{a.authService.altaEspecialista(a.nombre?.value,a.apellido?.value,a.dni?.value,a.fechaNacimiento?.value,a.mail?.value,a.password?.value,r.user?.uid,a.especialidadUsuario,a.imagen)}).then(()=>{m().fire({icon:"success",title:"Usuario registrado",text:"Por favor verifica tu correo para validar el acceso",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),a.nuevaEspecialidad?.pristine||a.dataqueryService.altaEspecialidad(a.nuevaEspecialidad?.value),a.router.navigate(["login"]),a.isLoading=!1})})}catch(r){switch(a.isLoading=!1,r.code){case"auth/email-already-in-use":m().fire({icon:"error",title:"Error en el usuario",text:"El correo ya se encuentra registrado"});break;case"auth/invalid-email":m().fire({icon:"error",title:"Error en el formato del correo",text:'El correo debe ser valido por ejemplo "nombre@correo.com"'});break;case"auth/weak-password":m().fire({icon:"error",title:"Error en el password",text:"El password debe contener al menos 6 car\xe1cteres"});break;default:console.error("Error durante la autenticaci\xf3n:",r)}}})()}cargarArchivo(a){this.archivo=a.target.files[0]}cargarImagen(a){var r=this;return(0,g.Z)(function*(){return new Promise(function(){var n=(0,g.Z)(function*(s,c){let d=new FileReader;d.onloadend=()=>{r.storageService.subirImagen(r.dni?.value+"_"+Date.now(),d.result,"empleado").then(f=>{r.imagen=f,s(!0)}).catch(f=>{c(f)})},d.readAsDataURL(a)});return function(s,c){return n.apply(this,arguments)}}())})()}static#e=this.\u0275fac=function(r){return new(r||t)(e.Y36(E.e),e.Y36(A.V),e.Y36(y.e),e.Y36(u.F0),e.Y36(i.qu),e.Y36(I.K))};static#a=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-register-empleado"]],decls:69,vars:15,consts:[[1,"form-principal"],[1,"px-4","py-5","px-md-5","text-center","text-lg-start"],[1,"container"],["class","overlay",4,"ngIf"],[1,"row","gx-lg-5","align-items-center"],[1,"col-lg-8","mb-5","mb-lg-0"],[1,"card"],[1,"card-body",2,"width","100%"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-6","mb-3"],["for","nombre"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],[4,"ngIf"],["for","apellido"],["type","text","id","apellido","formControlName","apellido",1,"form-control"],[1,"mb-3"],[1,"text-muted"],["type","text","id","dni","formControlName","dni",1,"form-control"],["type","text","id","mail","formControlName","mail",1,"form-control"],["type","password","id","password","formControlName","password",1,"form-control"],[1,"col-md-5","mb-3"],["formControlName","especialidad","multiple","",1,"custom-select","d-block","w-100"],[4,"ngFor","ngForOf"],["type","text","formControlName","nuevaEspecialidad",1,"form-control"],["type","date","id","fechaNacimiento","formControlName","fechaNacimiento",1,"form-control"],[1,"col-md-3","mb-3"],["type","file","accept",".png, .jpg, .jpeg","formControlName","img","id","inputFile",3,"change"],["for","inputFile",1,"labelInputFile"],["src","https://cdn-icons-png.flaticon.com/512/20/20829.png","alt","cargar imagen"],[3,"formGroup"],["formControlName","recaptcha",3,"siteKey","success"],["captchaElem",""],["type","submit",1,"btn","btn-danger","btn-block","mb-4",3,"disabled"],[1,"overlay"],[1,"spinner"],[1,"text-danger"]],template:function(r,n){1&r&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e.YNc(3,C,2,0,"div",3),e.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"form",8),e.NdJ("ngSubmit",function(){return n.registrarse()}),e.TgZ(9,"div",9)(10,"div")(11,"h2"),e._uU(12,"ESPECIALISTA"),e.qZA()(),e.TgZ(13,"div",10)(14,"label",11),e._uU(15,"Nombre"),e.qZA(),e._UZ(16,"input",12),e.YNc(17,N,3,0,"ng-container",13),e.qZA(),e.TgZ(18,"div",10)(19,"label",14),e._uU(20,"Apellido"),e.qZA(),e._UZ(21,"input",15),e.YNc(22,T,3,0,"ng-container",13),e.qZA()(),e.TgZ(23,"div",16)(24,"label"),e._uU(25,"DNI "),e._UZ(26,"span",17),e.qZA(),e._UZ(27,"input",18),e.YNc(28,U,3,0,"ng-container",13),e.qZA(),e.TgZ(29,"div",16)(30,"label"),e._uU(31,"Correo"),e._UZ(32,"span",17),e.qZA(),e._UZ(33,"input",19),e.YNc(34,x,3,0,"ng-container",13),e.qZA(),e.TgZ(35,"div",16)(36,"label"),e._uU(37,"Contrase\xf1a "),e._UZ(38,"span",17),e.qZA(),e._UZ(39,"input",20),e.YNc(40,w,3,0,"ng-container",13),e.qZA(),e.TgZ(41,"div",9)(42,"div",21)(43,"label"),e._uU(44,"Especialidad"),e.qZA(),e.TgZ(45,"select",22),e.YNc(46,q,3,3,"option",23),e.qZA()(),e.TgZ(47,"div",21)(48,"label"),e._uU(49,"Agregar Especialidad Personalizada"),e.qZA(),e._UZ(50,"input",24),e.YNc(51,F,3,0,"ng-container",13),e.qZA(),e.TgZ(52,"div",10)(53,"label"),e._uU(54,"Fecha de nacimiento"),e.qZA(),e._UZ(55,"input",25),e.YNc(56,S,3,0,"div",13),e.qZA()(),e.TgZ(57,"div",26)(58,"label"),e._uU(59,"Subir foto de perfil"),e.qZA(),e.TgZ(60,"input",27),e.NdJ("change",function(c){return n.cargarArchivo(c)}),e.qZA(),e.TgZ(61,"label",28),e._UZ(62,"img",29),e.qZA(),e.YNc(63,R,2,1,"span",13),e.qZA(),e.TgZ(64,"form",30)(65,"ngx-recaptcha2",31,32),e.NdJ("success",function(c){return n.handleSuccess(c)}),e.qZA()(),e.TgZ(67,"button",33),e._uU(68," Registrarse "),e.qZA()()()()()()()()()),2&r&&(e.Q6J("@fadeInUp",void 0),e.xp6(3),e.Q6J("ngIf",n.isLoading),e.xp6(5),e.Q6J("formGroup",n.form),e.xp6(9),e.Q6J("ngIf",null==n.nombre?null:n.nombre.hasError("pattern")),e.xp6(5),e.Q6J("ngIf",null==n.apellido?null:n.apellido.hasError("pattern")),e.xp6(6),e.Q6J("ngIf",null==n.dni?null:n.dni.hasError("pattern")),e.xp6(6),e.Q6J("ngIf",null==n.mail?null:n.mail.hasError("email")),e.xp6(6),e.Q6J("ngIf",null==n.password?null:n.password.hasError("minlength")),e.xp6(6),e.Q6J("ngForOf",n.especialidades),e.xp6(5),e.Q6J("ngIf",null==n.nuevaEspecialidad?null:n.nuevaEspecialidad.hasError("pattern")),e.xp6(5),e.Q6J("ngIf",null==n.fechaNacimiento?null:n.fechaNacimiento.hasError("fechaNacimientoInvalida")),e.xp6(7),e.Q6J("ngIf",null!=n.archivo),e.xp6(1),e.Q6J("formGroup",n.aFormGroup),e.xp6(1),e.Q6J("siteKey",n.siteKey),e.xp6(2),e.Q6J("disabled",n.form.invalid||n.isLoading||!n.captchaResolved))},dependencies:[p.sg,p.O5,i._Y,i.YN,i.Kr,i.Fj,i.K7,i.JJ,i.JL,i.sg,i.u,v.to,p.rS],styles:[".form-principal[_ngcontent-%COMP%]{margin-left:3.5rem}#inputFile[_ngcontent-%COMP%]{display:none}.labelInputFile[_ngcontent-%COMP%]{width:3rem;height:3rem;background-color:#d83051;border-radius:100%;padding:1rem;box-shadow:0 0 10px -1px #494949;display:flex;justify-content:center;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none}.labelInputFile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:2rem;height:2rem}.labelInputFile[_ngcontent-%COMP%]:active{transform:scale(.9)}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fffc;display:flex;align-items:center;justify-content:center;z-index:9999}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #e64141;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],data:{animation:[_.X]}})}return t})(),children:[]}];let Q=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#a=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(J),u.Bz]})}return t})(),k=(()=>{class t{static#e=this.\u0275fac=function(r){return new(r||t)};static#a=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[p.ez,Q,i.UX,v.e7]})}return t})()}}]);