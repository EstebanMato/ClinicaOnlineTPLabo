"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[838],{6838:(O,h,r)=>{r.r(h),r.d(h,{TurnoMostrarModule:()=>F});var c=r(6814),Z=r(9517),T=r(5861),b=r(2572),C=r(7398),x=r(3519),d=r.n(x),t=r(5879),v=r(9113),y=r(588),s=r(6223);function A(n,u){1&n&&(t.TgZ(0,"div",11),t._UZ(1,"div",12),t.qZA())}function U(n,u){if(1&n){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,a=t.oxw();return t.KtG(a.cancelarTurno(i))}),t._uU(1,"Cancelar "),t.qZA()}}function M(n,u){if(1&n&&(t.TgZ(0,"tr")(1,"td")(2,"p",13),t._uU(3),t.qZA()(),t.TgZ(4,"td")(5,"p",13),t._uU(6),t.qZA()(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"span",14),t._uU(15),t.qZA()(),t.TgZ(16,"td"),t.YNc(17,U,2,0,"button",15),t.qZA()()),2&n){const e=u.$implicit,o=t.oxw();t.xp6(3),t.Oqu(e.nombreEspecialista),t.xp6(3),t.Oqu(e.nombrePaciente),t.xp6(2),t.hij(" ",e.fecha," "),t.xp6(2),t.hij(" ",e.horaInicio," "),t.xp6(2),t.hij(" ",e.especialidad," "),t.xp6(2),t.Q6J("ngClass",o.getColorPorEstado(e.estado)),t.xp6(1),t.hij(" ",e.estado," "),t.xp6(2),t.Q6J("ngIf","pendiente"===e.estado)}}const E=[{path:"",component:(()=>{class n{constructor(e,o,i){this.turnoService=e,this.dataquery=o,this.formBuilder=i,this.isLoading=!1}ngOnInit(){this.filtroForm=this.formBuilder.group({especialidad:[""],especialista:[""]}),this.isLoading=!0;const e=this.turnoService.getTurnos(),o=this.turnoService.getEspecialistas(),i=this.dataquery.getPacientes();(0,b.a)([e,o,i]).pipe((0,C.U)(([a,l,q])=>a.map(p=>{const g=l.find(m=>m.uid===p.uidEspecialista),f=q.find(m=>m.uid===p.uidPaciente);return{...p,nombreEspecialista:g?`${g.apellido}, ${g.nombre}`:"Especialista no encontrado",nombrePaciente:f?`${f.apellido}, ${f.nombre}`:"Paciente no encontrado"}}))).subscribe(a=>{this.turnosDetallado=a,this.turnosFiltrado=this.turnosDetallado,this.isLoading=!1}),this.formSubscription=this.filtroForm.valueChanges.subscribe(a=>{this.turnosFiltrado=this.filtrarTurnos(this.turnosDetallado,a)})}filtrarTurnos(e,o){return e&&"string"==typeof o.especialidad?e.filter(i=>{const a="string"==typeof i.especialidad&&i.especialidad.toLowerCase().includes(o.especialidad?.toLowerCase()),l="string"==typeof i.nombreEspecialista&&i.nombreEspecialista.toLowerCase().includes(o.especialista?.toLowerCase());return a&&l}):[]}getColorPorEstado(e){switch(e){case"confirmado":return"badge rounded-pill text-bg-success";case"cancelado":case"rechazado":return"badge rounded-pill text-bg-danger";case"pendiente":return"badge rounded-pill text-bg-secondary";default:return"badge rounded-pill text-bg-muted"}}cancelarTurno(e){var i,o=this;d().fire({title:"\xbfDesea cancelar?",input:"text",inputPlaceholder:"Ingrese el motivo de la cancelaci\xf3n",showCancelButton:!0,cancelButtonText:"No",confirmButtonText:"S\xed, cancelar",showLoaderOnConfirm:!0,preConfirm:(i=(0,T.Z)(function*(a){console.log(e.id,a),o.turnoService.cancelarTurno(e.id,a)}),function(l){return i.apply(this,arguments)}),allowOutsideClick:()=>!d().isLoading()}).then(i=>{i.isConfirmed&&d().fire("Cancelado","El turno fue cancelado.","success")})}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(v.D),t.Y36(y.e),t.Y36(s.qu))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-turno-mostrar"]],decls:30,vars:3,consts:[["class","overlay",4,"ngIf"],[1,"turnos-container"],[3,"formGroup"],[1,"filtro-container"],["for","especialista"],["type","text","formControlName","especialista"],["for","especialidad"],["type","text","formControlName","especialidad"],[1,"table","align-middle","mb-0","bg-white"],[1,"bg-light"],[4,"ngFor","ngForOf"],[1,"overlay"],[1,"spinner"],[1,"fw-normal","mb-1"],[3,"ngClass"],["type","button","class","btn btn-outline-danger btn-sm",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"]],template:function(o,i){1&o&&(t.YNc(0,A,2,0,"div",0),t.TgZ(1,"div",1)(2,"form",2)(3,"div",3)(4,"label",4),t._uU(5,"Especialista:"),t.qZA(),t._UZ(6,"input",5),t.TgZ(7,"label",6),t._uU(8,"Especialidad:"),t.qZA(),t._UZ(9,"input",7),t.qZA(),t.TgZ(10,"table",8)(11,"thead",9)(12,"tr")(13,"th"),t._uU(14,"Especialista"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"Paciente"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"Fecha"),t.qZA(),t.TgZ(19,"th"),t._uU(20,"Hora"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Especialidad"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Estado"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Accion"),t.qZA()()(),t.TgZ(27,"tbody"),t.YNc(28,M,18,8,"tr",10),t._UZ(29,"tr"),t.qZA()()()()),2&o&&(t.Q6J("ngIf",i.isLoading),t.xp6(2),t.Q6J("formGroup",i.filtroForm),t.xp6(26),t.Q6J("ngForOf",i.turnosFiltrado))},dependencies:[c.mk,c.sg,c.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:[".overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fffc;display:flex;align-items:center;justify-content:center;z-index:9999}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #e64141;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.filtro-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin:10px}"]})}return n})(),children:[]}];let P=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[Z.Bz.forChild(E),Z.Bz]})}return n})(),F=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[c.ez,P,s.UX]})}return n})()}}]);