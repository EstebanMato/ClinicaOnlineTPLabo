"use strict";(self.webpackChunkclinica_online=self.webpackChunkclinica_online||[]).push([[151],{7151:(T,C,d)=>{d.r(C),d.d(C,{PacientesModule:()=>Z});var u=d(6814),o=d(9517),x=d(2572),D=d(7398),y=d(8304),e=d(5879),s=d(9113),n=d(154);let i=(()=>{class r{constructor(t,a){this.el=t,this.renderer=a}onMouseEnter(){this.applyEffect("#000080","scale(1.1)")}onMouseLeave(){this.applyEffect("","")}applyEffect(t,a){this.renderer.setStyle(this.el.nativeElement,"background-color",t),this.renderer.setStyle(this.el.nativeElement,"transform",a),this.renderer.setStyle(this.el.nativeElement,"transition","all 0.3s ease-in-out")}static#e=this.\u0275fac=function(a){return new(a||r)(e.Y36(e.SBq),e.Y36(e.Qsj))};static#t=this.\u0275dir=e.lG2({type:r,selectors:[["","appHoverEffect",""]],hostBindings:function(a,c){1&a&&e.NdJ("mouseenter",function(){return c.onMouseEnter()})("mouseleave",function(){return c.onMouseLeave()})}})}return r})();function l(r,_){if(1&r&&(e.ynx(0),e.TgZ(1,"p",16),e._uU(2),e.qZA(),e.BQk()),2&r){const t=_.$implicit;e.xp6(2),e.hij("Fecha: ",t.fecha,"")}}function f(r,_){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",10)(2,"div",11),e._UZ(3,"img",12),e.TgZ(4,"div",13)(5,"h5",14),e._uU(6),e.qZA(),e.YNc(7,l,3,1,"ng-container",2),e.TgZ(8,"a",15),e.NdJ("click",function(){const P=e.CHM(t).$implicit,b=e.oxw();return e.KtG(b.historiaClinicaPaciente(P))}),e._uU(9," Historia Clinica"),e.qZA()()()(),e.BQk()}if(2&r){const t=_.$implicit,a=e.oxw();e.xp6(3),e.Q6J("src",null==t?null:t.imagen[0],e.LSH),e.xp6(3),e.AsE("",t.apellido,", ",t.nombre,""),e.xp6(1),e.Q6J("ngForOf",a.obtenerTresTurnosPorPaciente(t.uid))}}function p(r,_){if(1&r&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.datosDinamicos.dato1.nombre,": ",t.datosDinamicos.dato1.valor,"")}}function m(r,_){if(1&r&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.datosDinamicos.dato2.nombre,": ",t.datosDinamicos.dato2.valor,"")}}function h(r,_){if(1&r&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&r){const t=e.oxw(2).$implicit;e.xp6(1),e.AsE("",t.datosDinamicos.dato3.nombre,": ",t.datosDinamicos.dato3.valor,"")}}function g(r,_){if(1&r&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e._uU(3),e._UZ(4,"br"),e._uU(5),e._UZ(6,"br"),e._uU(7),e._UZ(8,"br"),e._uU(9),e._UZ(10,"br"),e._uU(11),e._UZ(12,"br"),e._uU(13),e._UZ(14,"br"),e.YNc(15,p,3,2,"ng-container",17),e.YNc(16,m,3,2,"ng-container",17),e.YNc(17,h,3,2,"ng-container",17),e._UZ(18,"hr"),e.BQk()),2&r){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" Fecha: ",t.fecha,", ",t.horaInicio,""),e.xp6(2),e.hij(" Comentarios: ",t.comentarios,""),e.xp6(2),e.hij(" Altura: ",t.datosFijos.altura,""),e.xp6(2),e.hij(" Peso: ",t.datosFijos.peso,""),e.xp6(2),e.hij(" Presion: ",t.datosFijos.presion,""),e.xp6(2),e.hij(" Temperatura: ",t.datosFijos.temperatura,""),e.xp6(2),e.hij(" Diagnostico: ",t.datosFijos.diagnostico,""),e.xp6(2),e.Q6J("ngIf",""!=t.datosDinamicos.dato1.nombre),e.xp6(1),e.Q6J("ngIf",""!=t.datosDinamicos.dato2.nombre),e.xp6(1),e.Q6J("ngIf",""!=t.datosDinamicos.dato3.nombre)}}function v(r,_){if(1&r&&(e.ynx(0),e.YNc(1,g,19,11,"ng-container",17),e.BQk()),2&r){const t=_.$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngIf",t.uidPaciente==(null==a.pacienteSeleccionado?null:a.pacienteSeleccionado.uid))}}const U=[{path:"",component:(()=>{class r{constructor(t,a){this.turnoService=t,this.authService=a,this.isLoading=!1,this.arrayPacientes=[]}ngOnInit(){this.isLoading=!0,this.authService.getLoggedUser().subscribe(t=>{t&&this.authService.getUsuarioPorUid(t.uid).subscribe(a=>{this.usuario=a[0],this.isLoading=!1,this.getTurnosAtendidos()})})}getTurnosAtendidos(){this.isLoading=!0;const t=this.turnoService.getTurnos(),a=this.turnoService.getPacientes();(0,x.a)([t,a]).pipe((0,D.U)(([c,P])=>c.filter(b=>b.uidEspecialista===this.usuario?.uid&&"finalizado"===b.estado).map(b=>{const E=P.find(I=>I.uid===b.uidPaciente);return{...b,nombrepaciente:E?`${E.apellido}, ${E.nombre}`:"Paciente no encontrado"}}))).subscribe(c=>{this.turnosDetallado=this.ordenarPorFecha(c),this.isLoading=!1,this.arrayUidPacientes=this.getPacientesUnicos()})}getPacientesUnicos(){const t=[];return this.turnosDetallado&&this.turnosDetallado.forEach(a=>{a&&a.uidPaciente&&!t.includes(a.uidPaciente)&&(t.push(a.uidPaciente),this.authService.getUsuarioPorUid(a.uidPaciente).subscribe(c=>{this.arrayPacientes.push(c[0])}))}),t}ordenarPorFecha(t){return t.sort((a,c)=>{const P=this.convertirAFecha(a.fecha),b=this.convertirAFecha(c.fecha);return P.getTime()-b.getTime()}),t}convertirAFecha(t){const a=t.split("/");return new Date(parseInt(a[2]),parseInt(a[1])-1,parseInt(a[0]))}obtenerTresTurnosPorPaciente(t){let a=0;return this.turnosDetallado.filter(c=>c.uidPaciente===t&&a<3&&(a++,!0))}historiaClinicaPaciente(t){this.pacienteSeleccionado=t}static#e=this.\u0275fac=function(a){return new(a||r)(e.Y36(s.D),e.Y36(n.e))};static#t=this.\u0275cmp=e.Xpm({type:r,selectors:[["app-pacientes"]],decls:12,vars:5,consts:[[1,"container"],[1,"row","mt-4"],[4,"ngFor","ngForOf"],["id","HistoriaClinica","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabels",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"col-md-3","mb-3"],[1,"card",2,"width","100%"],["alt","imagenPerfil",1,"card-img-top","square-image",3,"src"],[1,"card-body"],[1,"card-title"],["data-bs-dismiss","modal","data-bs-toggle","modal","data-bs-target","#HistoriaClinica","appHoverEffect","",1,"btn","btn-primary",3,"click"],[1,"card-text"],[4,"ngIf"]],template:function(a,c){1&a&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,f,10,4,"ng-container",2),e.qZA()(),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"h5",7),e._uU(8),e.qZA(),e._UZ(9,"button",8),e.qZA(),e.TgZ(10,"div",9),e.YNc(11,v,2,1,"ng-container",2),e.qZA()()()()),2&a&&(e.Q6J("@fadeInUp",void 0),e.xp6(2),e.Q6J("ngForOf",c.arrayPacientes),e.xp6(6),e.AsE("",null==c.pacienteSeleccionado?null:c.pacienteSeleccionado.nombre,", ",null==c.pacienteSeleccionado?null:c.pacienteSeleccionado.apellido,". Historia cl\xednica "),e.xp6(3),e.Q6J("ngForOf",c.turnosDetallado))},dependencies:[u.sg,u.O5,i],styles:[".overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#fffc;display:flex;align-items:center;justify-content:center;z-index:9999}.spinner[_ngcontent-%COMP%]{border:4px solid rgba(255,255,255,.3);border-top:4px solid #e64141;border-radius:50%;width:50px;height:50px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.square-image[_ngcontent-%COMP%]{aspect-ratio:1/1;object-fit:cover}"],data:{animation:[y.X]}})}return r})(),children:[]}];let F=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=e.oAB({type:r});static#i=this.\u0275inj=e.cJS({imports:[u.ez,o.Bz.forChild(U),o.Bz]})}return r})();var S=d(2514);let Z=(()=>{class r{static#e=this.\u0275fac=function(a){return new(a||r)};static#t=this.\u0275mod=e.oAB({type:r});static#i=this.\u0275inj=e.cJS({imports:[u.ez,F,S.I]})}return r})()},9113:(T,C,d)=>{d.d(C,{D:()=>D});var u=d(5861),o=d(5349),x=d(5879);let D=(()=>{class y{constructor(s){this.firestore=s}getEspecialidades(){const s=(0,o.hJ)(this.firestore,"especialidades");return(0,o.BS)(s)}getEspecialistas(){const s=(0,o.hJ)(this.firestore,"usuarios"),n=(0,o.IO)(s,(0,o.ar)("perfil","==","especialista"),(0,o.ar)("estado","==",!0));return(0,o.BS)(n)}getPacientes(){const s=(0,o.hJ)(this.firestore,"usuarios"),n=(0,o.IO)(s,(0,o.ar)("perfil","==","paciente"),(0,o.ar)("estado","==",!0));return(0,o.BS)(n)}getTurnos(){const s=(0,o.hJ)(this.firestore,"turnos");return(0,o.BS)(s)}getTurnosPendientes(){const s=(0,o.hJ)(this.firestore,"turnos"),n=(0,o.IO)(s,(0,o.ar)("estado","==","pendiente"));return(0,o.BS)(n)}getTurnosFinalizados(){const s=(0,o.hJ)(this.firestore,"turnos"),n=(0,o.IO)(s,(0,o.ar)("estado","==","finalizado"));return(0,o.BS)(n)}getTurnosActivos(){const s=(0,o.hJ)(this.firestore,"turnos"),n=(0,o.IO)(s,(0,o.ar)("estado","!=","cancelado"));return(0,o.BS)(n)}crearTurno(s){var n=this;return(0,u.Z)(function*(){const i=yield n.getProxIdTurno(),l=(0,o.hJ)(n.firestore,"turnos");(0,o.ET)(l,{id:i,uidPaciente:s.uidPaciente,uidEspecialista:s.uidEspecialista,estado:s.estado,fecha:s.fecha,horaFin:s.horaFin,horaInicio:s.horaInicio,comentarios:s.comentarios,calificacion:s.calificacion,especialidad:s.especialidad,resenia:""})})()}getProxIdTurno(){var s=this;return(0,u.Z)(function*(){const n=(0,o.hJ)(s.firestore,"turnos"),i=(0,o.IO)(n,(0,o.Xo)("id","desc")),l=yield(0,o.PL)(i);return l.empty?1:l.docs[0].get("id")+1})()}cancelarTurno(s,n){var i=this;return(0,u.Z)(function*(){const l=(0,o.hJ)(i.firestore,"turnos"),f=(0,o.IO)(l,(0,o.ar)("id","==",s)),p=yield(0,o.PL)(f);return 0!==p.size&&(p.forEach(function(){var m=(0,u.Z)(function*(h){const g=h.ref;yield(0,o.pl)(g,{estado:"cancelado",comentarios:n},{merge:!0})});return function(h){return m.apply(this,arguments)}}()),!0)})()}finalizarTurno(s,n,i,l){var f=this;return(0,u.Z)(function*(){const p=(0,o.hJ)(f.firestore,"turnos"),m=(0,o.IO)(p,(0,o.ar)("id","==",s)),h=yield(0,o.PL)(m);return 0!==h.size&&(h.forEach(function(){var g=(0,u.Z)(function*(v){const L=v.ref;yield(0,o.pl)(L,{estado:"finalizado",comentarios:l,datosFijos:n,datosDinamicos:i},{merge:!0})});return function(v){return g.apply(this,arguments)}}()),!0)})()}confirmarTurno(s){var n=this;return(0,u.Z)(function*(){const i=(0,o.hJ)(n.firestore,"turnos"),l=(0,o.IO)(i,(0,o.ar)("id","==",s)),f=yield(0,o.PL)(l);return 0!==f.size&&(f.forEach(function(){var p=(0,u.Z)(function*(m){const h=m.ref;yield(0,o.pl)(h,{estado:"confirmado"},{merge:!0})});return function(m){return p.apply(this,arguments)}}()),!0)})()}calificarTurno(s,n,i){var l=this;return(0,u.Z)(function*(){const f=(0,o.hJ)(l.firestore,"turnos"),p=(0,o.IO)(f,(0,o.ar)("id","==",s)),m=yield(0,o.PL)(p);return 0!==m.size&&(m.forEach(function(){var h=(0,u.Z)(function*(g){const v=g.ref;yield(0,o.pl)(v,{resenia:n,calificacion:i},{merge:!0})});return function(g){return h.apply(this,arguments)}}()),!0)})()}filtrarTurnos(s,n){return s&&"string"==typeof n.filtrar?s.filter(i=>{const l="string"==typeof i.especialidad.nombre&&i.especialidad.nombre.toLowerCase().includes(n.filtrar?.toLowerCase()),f=i.nombreEspecialista&&"string"==typeof i.nombreEspecialista&&i.nombreEspecialista.toLowerCase().includes(n.filtrar?.toLowerCase()),p=i.nombrePaciente&&"string"==typeof i.nombrePaciente&&i.nombrePaciente.toLowerCase().includes(n.filtrar?.toLowerCase()),m="string"==typeof i.fecha&&i.fecha.toLowerCase().includes(n.filtrar?.toLowerCase()),h="string"==typeof i.horaInicio&&i.horaInicio.toLowerCase().includes(n.filtrar?.toLowerCase()),g="string"==typeof i.estado&&i.estado.toLowerCase().includes(n.filtrar?.toLowerCase()),v=i.datosDinamicos&&("string"==typeof i.datosDinamicos.dato1?.nombre&&i.datosDinamicos.dato1.nombre.toLowerCase().includes(n.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato2?.nombre&&i.datosDinamicos.dato2.nombre.toLowerCase().includes(n.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato3?.nombre&&i.datosDinamicos.dato3.nombre.toLowerCase().includes(n.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato1?.valor&&i.datosDinamicos.dato1.valor.toLowerCase().includes(n.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato2?.valor&&i.datosDinamicos.dato2.valor.toLowerCase().includes(n.filtrar?.toLowerCase())||"string"==typeof i.datosDinamicos.dato3?.valor&&i.datosDinamicos.dato3.valor.toLowerCase().includes(n.filtrar?.toLowerCase())),L=i.datosFijos&&("number"==typeof i.datosFijos.altura&&i.datosFijos.altura.toString().includes(n.filtrar)||"string"==typeof i.datosFijos.diagnostico&&i.datosFijos.diagnostico.toLowerCase().includes(n.filtrar?.toLowerCase())||"number"==typeof i.datosFijos.peso&&i.datosFijos.peso.toString().includes(n.filtrar)||"number"==typeof i.datosFijos.presion&&i.datosFijos.presion.toString().includes(n.filtrar)||"number"==typeof i.datosFijos.temperatura&&i.datosFijos.temperatura.toString().includes(n.filtrar));return l||p||f||m||h||g||v||L}):[]}static#e=this.\u0275fac=function(n){return new(n||y)(x.LFG(o.gg))};static#t=this.\u0275prov=x.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()}}]);